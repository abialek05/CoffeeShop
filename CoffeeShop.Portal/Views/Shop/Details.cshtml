@model CoffeeShop.Database.Data.CMS.Product
@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_ShopLayout.cshtml";
}

<section class="ftco-section">
	<div class="container">
		<div class="row">
			<div class="col-lg-6 mb-5 ftco-animate">
				<img src="@Model.PhotoURL" style="block-size: 400px">
			</div>
			<div class="col-lg-6 product-details pl-md-5 ftco-animate">
				<h3>@Model.ProductName</h3>
				<p class="price"><span>@String.Format("{0:F}", @Model.Price) PLN</span></p>
				<p>
					@Model.DescriptionLong
				</p>
				<div class="row mt-4">					
					<div class="w-100"></div>
					@if (Model.FlavorNotes != "")
					{
						<div>						
							<a id="quantity" name="quantity" class="form-control input-number">Nuty smakowe: @Model.FlavorNotes</a>
						</div>
						<div class="w-100"></div>
					} else
					{
						<div class="w-100"></div>
					}
					@*<div>
						<a id="quantity" name="quantity" class="form-control input-number">Waga: @Model.Weight g</a>
					</div>
					<div class="w-100"></div>
					<div class="input-group col-md-6 d-flex mb-3">
						<span class="input-group-btn mr-2">
							<button type="button" class="quantity-left-minus btn" data-type="minus" data-field="">
								<i class="icon-minus"></i>
							</button>
						</span>
						<input type="text" id="quantity" name="quantity" class="form-control input-number" value="1" min="1" max="100">
						<span class="input-group-btn ml-2">
							<button type="button" class="quantity-right-plus btn" data-type="plus" data-field="">
								<i class="icon-plus"></i>
							</button>
						</span>
					</div>
				</div>			*@
					<div style="margin-top: 10px;">
						<a id="weight" name="weight" class="form-control input-number">Waga: @Model.Weight g</a>
					</div>
					<div class="w-100"></div>
					<div class="input-group col-md-6 d-flex mb-3" style="margin-left: -15px; margin-top: 10px;">
						<span class="input-group-btn mr-2">
							<button name="minus" type="button" class="quantity-left-minus btn" data-type="minus" data-field="" onclick="javascript:substractClick()">
								<i class="icon-minus"></i>
							</button>
						</span>
						<span type="text" id="quantityClicked" name="quantity" class="form-control input-number" min="1" max="100">1</span>
						<span class="input-group-btn ml-2">
							<button type="button" name="plus" class="quantity-right-plus btn" data-type="plus" data-field="" onclick="javascript:addClick()">
								<i class="icon-plus"></i>
							</button>
						</span>
					</div>
                </div>
				<div class="nav-item cart">
					<button onclick="addToCart(@Model.IdProduct)" class="btn btn-primary btn-outline-primary">Dodaj do koszyka</button>
				</div>
			</div>
		</div>
	</div>
</section>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
	var quantityClicked = 0;
	function addClick() {
		if (quantityClicked <= 99)
		{
		quantityClicked++;
		document.getElementById('quantityClicked').innerHTML = quantityClicked;
		return true
		}
	}
	function substractClick() {
		if (quantityClicked > 0) {
			quantityClicked--;
			document.getElementById('quantityClicked').innerHTML = quantityClicked;
			return true
		}
	}

	function addToCart(productId) {
		var quantityClicked = parseInt(document.getElementById('quantityClicked').innerText);

		// Create a form data object
		var formData = new FormData();
		formData.append('id', productId);
		formData.append('quantity', quantityClicked);

		// Send the form data to the server-side code using AJAX
		$.ajax({
			url: '/Cart/AddToCart', // Replace with the actual URL and action method
			type: 'POST',
			data: formData,
			processData: false,
			contentType: false,
			success: function (response) {
				// Handle the success response if needed
				window.location.href = '/Cart/Index'; // Redirect to the cart page after adding to cart
			},
			error: function (xhr, status, error) {
				// Handle the error response if needed
			}
		});
	}

</script>  